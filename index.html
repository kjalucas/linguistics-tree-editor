<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Linguistics Tree Studio - Overleaf Edition</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        :root { --primary: #3b9c37; --active: #dbeafe; --line-color: #000; }
        body { margin: 0; height: 100vh; display: flex; font-family: 'Segoe UI', sans-serif; overflow: hidden; user-select: none; background-color: #f9f9f9; }
        
        /* Layout */
        .workspace { flex: 1; display: flex; flex-direction: column; position: relative; }
        .toolbar { padding: 10px 20px; background: #fff; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .btn-action { background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 14px; }
        .btn-action:hover { background: #2e7d2b; }

        /* Canvas & SVG */
        .canvas { flex: 1; overflow: auto; display: flex; justify-content: center; padding-top: 60px; position: relative; }
        .svg-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        
        /* Arrow Styling */
        path { fill: none; stroke: #000; stroke-width: 1.5; marker-end: url(#arrowhead); transition: d 0.1s; }
        .arrow-handle { 
            fill: white; stroke: var(--primary); stroke-width: 2; cursor: pointer; pointer-events: auto; 
            transition: r 0.2s; z-index: 50;
        }
        .arrow-handle:hover { r: 6; stroke: #1d4ed8; }

        /* Tree Lines */
        .tree ul { display: flex; justify-content: center; padding-top: 20px; position: relative; margin: 0; padding-left: 0; }
        .tree li { float: left; text-align: center; list-style-type: none; position: relative; padding: 20px 10px 0 10px; }
        .tree li::before, .tree li::after {
            content: ''; position: absolute; top: 0; right: 50%;
            border-top: 2px solid var(--line-color); width: 50%; height: 20px; z-index: -1;
        }
        .tree li::after { right: auto; left: 50%; border-left: 2px solid var(--line-color); }
        .tree li:only-child::after, .tree li:only-child::before { display: none; }
        .tree li:only-child { padding-top: 0; }
        .tree li:first-child::before, .tree li:last-child::after { border: 0 none; }
        .tree li:last-child::before { border-right: 2px solid var(--line-color); border-radius: 0 5px 0 0; }
        .tree li:first-child::after { border-radius: 5px 0 0 0; }

        /* Nodes */
        .node-container { position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; }
        .node-card {
            background: white;
